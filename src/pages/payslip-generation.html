<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Payslip Generation | Nexus Payroll</title>
    <link rel="stylesheet" href="../output.css" />
    <link rel="stylesheet" href="../css/ag-grid/ag-theme-quartz.css" />
  </head>
  <body class="flex">
    <!-- Sidebar placeholder -->
    <div id="sidebar"></div>

    <!-- Main content -->
    <main class="flex-1 p-6">
      <h1 class="text-3xl font-medium">Payslip Generation</h1>

      <!-- Search and Cutoff Div -->
      <div class="mt-5 flex flex-wrap items-center justify-between gap-4">
        <!-- Search Bar -->
        <label
          class="input border border-accent focus-within:border-accent"
          aria-label="Search employees"
        >
          <svg
            class="h-[1em] opacity-50"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
          >
            <g
              stroke-linejoin="round"
              stroke-linecap="round"
              stroke-width="2.5"
              fill="none"
              stroke="currentColor"
            >
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.3-4.3"></path>
            </g>
          </svg>
          <input
            id="searchInput"
            type="search"
            placeholder="Search by name or ID"
            class="bg-transparent focus:outline-none"
          />
        </label>

        <!-- Cutoff Period -->
        <div class="flex flex-row items-center">
          <p class="mr-5">Cutoff Period</p>
          <fieldset class="fieldset">
            <select
              id="cutoffPeriod"
              class="select select-accent w-48"
              aria-label="Select cutoff period"
            >
              <option>All Cutoff</option>
              <option>Sep 1 - 15</option>
              <option selected>Sep 16 - 30</option>
              <option>Oct 1 - 15</option>
              <option>Oct 16 - 31</option>
            </select>
          </fieldset>
        </div>
      </div>

      <!-- AG Grid -->
      <div id="payslipGrid" class="mt-5 h-[470px] w-full ag-theme-quartz"></div>

      <!-- Generate PDF Button -->
      <div class="flex justify-end mt-5">
        <button id="generatePdfBtn" class="btn btn-secondary btn-lg">
          Generate PDF
        </button>
      </div>
    </main>

    <!-- Preview Modal -->
    <dialog
      id="previewModal"
      class="modal"
      aria-labelledby="previewTitle"
      role="dialog"
    >
      <div
        class="modal-box max-w-4xl w-full max-h-[95vh] p-0 my-auto overflow-y-auto"
      >
        <form method="dialog">
          <button
            class="btn btn-sm btn-circle btn-ghost absolute right-4 top-4 z-10 bg-base-100"
            aria-label="Close modal"
          >
            âœ•
          </button>
        </form>

        <header class="bg-base-200 dark:bg-base-300 px-8 py-6">
          <h3 id="previewTitle" class="text-2xl font-bold">Preview</h3>
        </header>

        <div class="p-8">
          <!-- Header Section -->
          <div class="bg-base-200 dark:bg-base-300 rounded-xl p-6 mb-6">
            <div class="flex items-start justify-between gap-8">
              <!-- Left: Company Info -->
              <div class="flex items-center gap-4">
                <div
                  class="w-16 h-16 rounded-full bg-primary text-primary-content flex items-center justify-center font-bold text-xl flex-shrink-0 shadow-lg"
                >
                  CN
                </div>
                <div>
                  <div class="font-bold text-xl">Company Name</div>
                  <div class="text-sm text-gray-500 dark:text-gray-400 mt-1">
                    Company Address
                  </div>
                </div>
              </div>

              <!-- Center: Payslip Title -->
              <div class="text-center flex-shrink-0">
                <div
                  class="text-4xl font-extrabold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent"
                >
                  Payslip
                </div>
              </div>

              <!-- Right: Dates -->
              <div class="text-right space-y-3 flex-shrink-0 min-w-[200px]">
                <div>
                  <div
                    class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide"
                  >
                    Salary Statement
                  </div>
                  <div id="previewPeriod" class="font-bold text-base mt-1">
                    09/01/25 - 09/15/25
                  </div>
                </div>
                <div>
                  <div
                    class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide"
                  >
                    Date Issued
                  </div>
                  <div id="previewIssued" class="font-bold text-base mt-1">
                    09/16/25
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Employee Info Section -->
          <div class="mt-6 bg-base-200 dark:bg-base-300 rounded-lg p-5">
            <div class="grid grid-cols-2 gap-x-8 gap-y-3">
              <div class="flex items-baseline gap-2">
                <span
                  class="text-sm text-gray-500 dark:text-gray-400 min-w-[120px]"
                  >Employee ID:</span
                >
                <span id="previewEmpId" class="font-bold">010101</span>
              </div>
              <div class="flex items-baseline gap-2">
                <span
                  class="text-sm text-gray-500 dark:text-gray-400 min-w-[100px]"
                  >Department:</span
                >
                <span id="previewDept" class="font-bold">IT</span>
              </div>
              <div class="flex items-baseline gap-2">
                <span
                  class="text-sm text-gray-500 dark:text-gray-400 min-w-[120px]"
                  >Employee Name:</span
                >
                <span id="previewEmpName" class="font-bold"
                  >Dela Cruz, Juan</span
                >
              </div>
              <div class="flex items-baseline gap-2">
                <span
                  class="text-sm text-gray-500 dark:text-gray-400 min-w-[100px]"
                  >Position:</span
                >
                <span id="previewPos" class="font-bold">IT Support</span>
              </div>
            </div>
          </div>

          <!-- Main Panels: Two Columns -->
          <div class="grid grid-cols-2 gap-6 mt-6">
            <!-- LEFT PANEL -->
            <div class="space-y-6">
              <!-- Gross Earnings -->
              <div
                class="rounded-lg border border-gray-300 dark:border-gray-600 overflow-hidden"
              >
                <div
                  class="bg-base-200 dark:bg-base-300 px-4 py-3 border-b border-gray-300 dark:border-gray-600"
                >
                  <h4 class="font-bold text-base">Gross Earnings</h4>
                </div>
                <div class="bg-base-100 dark:bg-base-200 p-4 space-y-3">
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-500 dark:text-gray-400"
                      >Regular Pay</span
                    >
                    <span id="previewRegularPay" class="font-bold tabular-nums"
                      >15,000.00</span
                    >
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-500 dark:text-gray-400"
                      >OT</span
                    >
                    <span id="previewOT" class="font-bold tabular-nums"
                      >1,500.00</span
                    >
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-500 dark:text-gray-400"
                      >Leave Pay</span
                    >
                    <span id="previewLeavePay" class="font-bold tabular-nums"
                      >0.00</span
                    >
                  </div>
                </div>
              </div>

              <!-- Attendance Summary -->
              <div
                class="rounded-lg border border-gray-300 dark:border-gray-600 overflow-hidden"
              >
                <div
                  class="bg-base-200 dark:bg-base-300 px-4 py-3 border-b border-gray-300 dark:border-gray-600"
                >
                  <h4 class="font-bold text-base">Attendance Summary</h4>
                </div>
                <div class="bg-base-100 dark:bg-base-200 p-4 space-y-3">
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-500 dark:text-gray-400"
                      >Working Hours</span
                    >
                    <span
                      id="previewWorkingHours"
                      class="font-bold tabular-nums"
                      >168.00</span
                    >
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-500 dark:text-gray-400"
                      >Absences</span
                    >
                    <span id="previewAbsences" class="font-bold tabular-nums"
                      >12.00</span
                    >
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-500 dark:text-gray-400"
                      >Tardiness</span
                    >
                    <span id="previewTardiness" class="font-bold tabular-nums"
                      >0.00</span
                    >
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-500 dark:text-gray-400"
                      >Undertime</span
                    >
                    <span id="previewUndertime" class="font-bold tabular-nums"
                      >0.00</span
                    >
                  </div>
                </div>
              </div>
            </div>

            <!-- RIGHT PANEL -->
            <div>
              <div
                class="rounded-lg border border-gray-300 dark:border-gray-600 overflow-hidden"
              >
                <!-- Gov. Contributions -->
                <div
                  class="bg-base-200 dark:bg-base-300 px-4 py-3 border-b border-gray-300 dark:border-gray-600"
                >
                  <h4 class="font-bold text-base">Gov. Contributions</h4>
                </div>
                <div class="bg-base-100 dark:bg-base-200 p-4 space-y-3">
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-500 dark:text-gray-400"
                      >SSS Contribution</span
                    >
                    <span id="previewSSS" class="font-bold tabular-nums"
                      >1,125.00</span
                    >
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-500 dark:text-gray-400"
                      >PhilHealth</span
                    >
                    <span id="previewPhilhealth" class="font-bold tabular-nums"
                      >450.00</span
                    >
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-500 dark:text-gray-400"
                      >Pag-ibig</span
                    >
                    <span id="previewPagibig" class="font-bold tabular-nums"
                      >100.00</span
                    >
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-500 dark:text-gray-400"
                      >Withholding Tax</span
                    >
                    <span id="previewTax" class="font-bold tabular-nums"
                      >1,250.00</span
                    >
                  </div>
                </div>

                <!-- Summary Section -->
                <div
                  class="bg-base-100 dark:bg-base-200 px-4 py-4 space-y-3 border-t-2 border-gray-300 dark:border-gray-600"
                >
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-500 dark:text-gray-400"
                      >Gross Earnings</span
                    >
                    <span id="previewGross" class="font-bold tabular-nums"
                      >16,500.00</span
                    >
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-500 dark:text-gray-400"
                      >Total Deductions</span
                    >
                    <span id="previewDeductions" class="font-bold tabular-nums"
                      >2,925.00</span
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Net Pay Section -->
          <div
            class="mt-6 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-950 dark:to-emerald-950 border-2 border-green-300 dark:border-green-700 rounded-lg p-5"
          >
            <div class="flex justify-between items-center">
              <span class="font-semibold text-gray-700 dark:text-gray-300"
                >Net Pay</span
              >
              <span
                id="previewNetPay"
                class="text-3xl font-extrabold text-green-600 dark:text-green-400 tabular-nums"
                >13,575.00</span
              >
            </div>
          </div>

          <!-- Signature Section -->
          <div class="mt-6 bg-base-200 dark:bg-base-300 rounded-lg p-5">
            <div class="grid grid-cols-2 gap-12">
              <div>
                <div class="text-sm text-gray-500 dark:text-gray-400 mb-8">
                  Received By: ______________________________
                </div>
                <div
                  class="border-b-2 border-gray-400 dark:border-gray-500 pb-1"
                ></div>
              </div>
              <div>
                <div class="text-sm text-gray-500 dark:text-gray-400 mb-8">
                  Date Received: ______________________________
                </div>
                <div
                  class="border-b-2 border-gray-400 dark:border-gray-500 pb-1"
                ></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <form method="dialog" class="modal-backdrop">
        <button>close</button>
      </form>
    </dialog>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script type="module" src="../js/supabase/supabaseClient.js"></script>
    <script src="../js/layout/sidebar.js"></script>
    <script src="../js/libs/ag-grid-community.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script type="module" src="../js/payslip-generation/main.js"></script>
  </body>
</html>
